var f=Object.defineProperty;var g=(s,t,e)=>t in s?f(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var i=(s,t,e)=>g(s,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const h of o)if(h.type==="childList")for(const d of h.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function e(o){const h={};return o.integrity&&(h.integrity=o.integrity),o.referrerPolicy&&(h.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?h.credentials="include":o.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function r(o){if(o.ep)return;o.ep=!0;const h=e(o);fetch(o.href,h)}})();class n{constructor(t,e){i(this,"_x",0);i(this,"_y",0);this._x=t,this._y=e}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}add(t){return new n(this._x+t._x,this._y+t._y)}scale(t){return new n(this._x*t,this._y*t)}normalize(){let t=this.magnitude();return new n(this._x/t,this._y/t)}magnitude(){return Math.sqrt(this._x*this._x+this._y*this._y)}difference(t){return new n(this._x-t._x,this._y-t._y)}angle(){return Math.atan2(this._y,this._x)*(180/Math.PI)}static getVectorFromAngle(t){let e=t*Math.PI/180;return new n(Math.cos(e),Math.sin(e))}getDirectionToObject(t){return t.Position.difference(this).normalize()}}class a{constructor(t){i(this,"div");i(this,"position",new n(0,0));i(this,"rotation",0);this.div=document.createElement(t),document.getElementsByTagName("game")[0].appendChild(this.div)}get Position(){return this.position}get Rotation(){return this.rotation}get width(){return this.div.clientWidth}get height(){return this.div.clientHeight}update(){this.draw()}draw(){this.div.style.transform=`translate(${this.position.x-this.width/2}px, ${this.position.y-this.height/2}px) rotate(${this.rotation}deg)`}hasCollision(t){return this.position.x<t.position.x+t.width&&this.position.y<t.position.y+t.height&&this.position.x+this.width>t.position.x&&this.position.y+this.height>t.position.y}}class u extends a{constructor(e,r){super(e);i(this,"damage",15);i(this,"speed",10);i(this,"parentTurret");i(this,"direction");this.parentTurret=r.Turret,this.position=this.parentTurret.Position,this.rotation=this.parentTurret.Rotation,this.direction=n.getVectorFromAngle(this.rotation);let o=30;this.position=this.Position.add(this.direction.scale(o))}get Damage(){return this.damage}get ParentTurret(){return this.parentTurret}update(){this.position=this.Position.add(this.direction.scale(this.speed)),super.update()}onCollision(e){}}class l extends u{constructor(t){super("bullet",t)}}class m extends u{constructor(t){super("missile",t)}}class y extends u{constructor(t){super("rocket",t)}}class p extends a{constructor(e,r,o,h){super(r);i(this,"speed",1);i(this,"game");i(this,"player");i(this,"type");this.game=e,this.type=r,this.player=h,this.position=o}update(){this.position=this.position.add(this.position.getDirectionToObject(this.player).scale(this.speed)),this.rotation=this.position.getDirectionToObject(this.player).angle(),super.update()}onCollision(e){if(e instanceof l&&this.type=="enemy-light"||e instanceof y&&this.type=="enemy-medium"||e instanceof m&&this.type=="enemy-heavy"){let r=this.game.gameObjects.indexOf(this);r>-1&&this.game.gameObjects.splice(r,1),this.div.remove()}}}class w extends a{constructor(e){super("tank-turret");i(this,"tank");i(this,"speed",new n(0,0));this.tank=e}update(){this.position=new n(this.tank.Position.x,this.tank.Position.y),this.speed=this.tank.Speed,this.rotation=this.tank.Rotation,super.update()}onCollision(e){throw new Error("Method not implemented.")}}class x extends a{constructor(e){super("tank-body");i(this,"FRICTION",.3);i(this,"ACCELERATION",.2);i(this,"turnLeft",!1);i(this,"turnRight",!1);i(this,"accelerate",!1);i(this,"canFire",!0);i(this,"previousState",!1);i(this,"rotationSpeed",2);i(this,"turret");i(this,"game");i(this,"fireRate",100);i(this,"speed",new n(0,0));this.game=e,this.position.x=visualViewport.width/2,this.position.y=visualViewport.height/2,this.speed=new n(0,0),this.rotation=0,this.turret=new w(this),window.addEventListener("keydown",r=>this.handleKeyDown(r)),window.addEventListener("keyup",r=>this.handleKeyUp(r))}get Speed(){return this.speed}get Turret(){return this.turret}update(){this.turret.update(),this.turnLeft?this.rotation-=this.rotationSpeed:this.turnRight&&(this.rotation+=this.rotationSpeed),this.accelerate?(this.speed.x<5&&(this.speed.x+=this.ACCELERATION),this.speed.y<5&&(this.speed.y+=this.ACCELERATION)):(this.speed.x>0&&(this.speed.x-=this.FRICTION),this.speed.y>0&&(this.speed.y-=this.FRICTION)),this.speed.x<0&&(this.speed.x=0),this.speed.y<0&&(this.speed.y=0),this.position.x+=Math.cos(this.degToRad(this.rotation))*this.speed.x,this.position.y+=Math.sin(this.degToRad(this.rotation))*this.speed.y,this.keepInWindow(),super.update()}handleKeyDown(e){e.key=="ArrowLeft"?this.turnLeft=!0:e.key=="ArrowRight"&&(this.turnRight=!0),e.key=="ArrowUp"&&(this.accelerate=!0),e.key==" "&&this.fire()}handleKeyUp(e){e.key=="ArrowLeft"?this.turnLeft=!1:e.key=="ArrowRight"&&(this.turnRight=!1),e.key=="ArrowUp"&&(this.accelerate=!1),e.key==" "&&(this.previousState=!1)}fire(){this.canFire&&!this.previousState&&(this.game.gameObjects.push(new l(this)),this.previousState=!0,this.canFire=!1,setTimeout(()=>{this.canFire=!0},this.fireRate))}onCollision(e){}keepInWindow(){this.position.x+this.width<0&&(this.position.x=window.innerWidth),this.position.y+this.height<0&&(this.position.y=window.innerHeight),this.position.x>window.innerWidth&&(this.position.x=-this.width),this.position.y>window.innerHeight&&(this.position.y=-this.height)}degToRad(e){return e*Math.PI/180}}class c extends a{constructor(t,e){super(t),this.position=e}}class O extends c{constructor(t){super("ammo-bullet",t)}onCollision(t){}}class T extends c{constructor(t){super("ammo-rocket",t)}onCollision(t){}}class k extends c{constructor(t){super("ammo-missile",t)}onCollision(t){}}class C{constructor(){i(this,"gameObjects",[]);this.gameObjects.push(new O(new n(800,200))),this.gameObjects.push(new T(new n(500,200))),this.gameObjects.push(new k(new n(500,500)));let t=new x(this);this.gameObjects.push(t),this.gameObjects.push(new p(this,"enemy-light",new n(50,50),t)),this.gameObjects.push(new p(this,"enemy-medium",new n(visualViewport.width-50,visualViewport.height-50),t)),this.gameObjects.push(new p(this,"enemy-heavy",new n(0,visualViewport.height-50),t)),this.gameLoop()}gameLoop(){for(const t of this.gameObjects)t.update();for(const t of this.gameObjects)this.checkCollision(t);requestAnimationFrame(()=>this.gameLoop())}checkCollision(t){for(const e of this.gameObjects)t!=e&&t.hasCollision(e)&&t.onCollision(e)}}window.addEventListener("DOMContentLoaded",()=>new C);
